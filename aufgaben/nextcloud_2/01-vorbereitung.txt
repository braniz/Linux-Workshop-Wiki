====== 01 - Vorbereitung der Nextcloud Installation ======

===== Lernziele =====

Nach dieser Lektion k√∂nnen Sie:
  * Systemanforderungen pr√ºfen und verstehen
  * Das System f√ºr die Nextcloud-Installation vorbereiten
  * Wichtige Sicherheits√ºberlegungen bewerten
  * Einen Installationsplan erstellen

===== Systemanforderungen =====

**Minimale Anforderungen:**
^ Komponente ^ Minimum ^ Empfohlen ^
| **Betriebssystem** | Ubuntu 20.04 LTS | Ubuntu 24.04 LTS |
| **RAM** | 1 GB | 4 GB+ |
| **Speicherplatz** | 10 GB | 50 GB+ |
| **PHP Version** | 8.1 | 8.3+ |
| **Webserver** | Apache 2.4 | Apache 2.4+ oder Nginx |
| **Datenbank** | MariaDB 10.6 | MariaDB 10.11+ |

===== System-Check durchf√ºhren =====

**1. Betriebssystem-Version pr√ºfen:**
<code>
lsb_release -a
</code>

**Erwartete Ausgabe:**
<code>
Description:    Ubuntu 24.04.x LTS
Release:        24.04
Codename:       noble
</code>

**2. Verf√ºgbaren Speicherplatz pr√ºfen:**
<code>
df -h /
</code>

**3. RAM-Status pr√ºfen:**
<code>
free -h
</code>

**4. Aktuelles PHP pr√ºfen (falls installiert):**
<code>
php --version
</code>

===== Netzwerk-Planung =====

**IP-Adresse des Servers ermitteln:**
<code>
ip addr show
# oder
hostname -I
</code>

<WRAP center round tip 70%>
**üí° Tipp:** Notieren Sie sich die IP-Adresse - Sie ben√∂tigen sie sp√§ter f√ºr den Zugriff auf die Nextcloud-Weboberfl√§che.

Beispiel: `http://192.168.1.100/nextcloud`
</WRAP>

**Ports pr√ºfen (sollten frei sein):**
<code>
# HTTP (Port 80)
sudo netstat -tuln | grep :80

# HTTPS (Port 443) - f√ºr sp√§tere SSL-Konfiguration
sudo netstat -tuln | grep :443
</code>

===== Sicherheitsplanung =====

**Schulungsumgebung vs. Produktion:**

<WRAP center round important 80%>
**üéì SCHULUNGSUMGEBUNG**

In diesem Workshop verwenden wir bewusst einfache Einstellungen:
  * **Einfache Passw√∂rter** f√ºr bessere Merkbarkeit
  * **HTTP statt HTTPS** f√ºr weniger Komplexit√§t
  * **Lokale Installation** ohne Internet-Zugang

**‚ö†Ô∏è F√ºr Produktionssysteme beachten Sie:**
  * Starke, einzigartige Passw√∂rter
  * SSL/TLS-Verschl√ºsselung (HTTPS)
  * Firewall-Konfiguration
  * Regelm√§√üige Sicherheitsupdates
</WRAP>

**Passwort-√úbersicht f√ºr diesen Workshop:**
^ Service ^ Benutzer ^ Passwort ^
| **Nextcloud Admin** | Admin | Start1234 |
| **MariaDB Root** | root | Start1234 |
| **Nextcloud DB** | nc_user | nc_pass |

===== System vorbereiten =====

**1. System aktualisieren:**
<code>
sudo apt update && sudo apt upgrade -y
</code>

**2. Firewall-Status pr√ºfen (Ubuntu):**
<code>
sudo ufw status
</code>

**Falls UFW aktiv ist, HTTP-Zugriff erlauben:**
<code>
sudo ufw allow 80/tcp
sudo ufw allow 22/tcp  # SSH beibehalten
</code>

**3. Verf√ºgbare Pakete pr√ºfen:**
<code>
apt list --upgradable
</code>

===== Verzeichnisstruktur planen =====

**Standard-Pfade die verwendet werden:**

^ Zweck ^ Pfad ^ Beschreibung ^
| **Nextcloud-Installation** | `/var/www/html/nextcloud/` | Hauptverzeichnis der Anwendung |
| **Datenverzeichnis** | `/var/www/html/nextcloud/data/` | Benutzerdaten und Dateien |
| **Konfiguration** | `/var/www/html/nextcloud/config/` | Konfigurationsdateien |
| **Apache-Konfiguration** | `/etc/apache2/sites-available/` | Webserver-Einstellungen |
| **PHP-Konfiguration** | `/etc/php/8.3/apache2/` | PHP-Einstellungen |
| **MariaDB-Daten** | `/var/lib/mysql/` | Datenbankdateien |

**Erforderliche Berechtigungen:**
  * Nextcloud-Dateien: Besitzer `www-data:www-data`
  * Konfigurationsdateien: Lesbar f√ºr Webserver
  * Datenverzeichnis: Schreibrechte f√ºr `www-data`

===== Zeitplanung =====

**Gesch√§tzte Installationszeiten:**

^ Phase ^ Dauer ^ Beschreibung ^
| **Systemvorbereitung** | 5-10 Min | Updates und Grundpakete |
| **Webserver + DB** | 10-15 Min | Apache und MariaDB Installation |
| **PHP-Module** | 5-10 Min | Erforderliche PHP-Erweiterungen |
| **Nextcloud Download** | 5 Min | Herunterladen und Entpacken |
| **Web-Setup** | 10 Min | Browser-basierte Konfiguration |
| **Optimierung** | 15-20 Min | Performance und Sicherheit |

**Gesamtzeit:** ~50-70 Minuten (je nach Erfahrung)

===== Troubleshooting-Vorbereitung =====

**Wichtige Log-Dateien:**
<code>
# Apache-Logs
sudo tail -f /var/log/apache2/error.log
sudo tail -f /var/log/apache2/access.log

# System-Logs
sudo journalctl -f

# Sp√§ter: Nextcloud-Logs
sudo tail -f /var/www/html/nextcloud/data/nextcloud.log
</code>

**N√ºtzliche Diagnose-Befehle:**
<code>
# Service-Status pr√ºfen
sudo systemctl status apache2
sudo systemctl status mysql

# Speicherplatz √ºberwachen
watch df -h

# Prozesse √ºberwachen
htop
</code>

===== Backup-Strategie (Schulung) =====

**Vor der Installation - VM-Snapshot erstellen:**

Falls Sie in einer virtuellen Maschine arbeiten:
<code>
# Bei VirtualBox: Snapshot erstellen
# Bei VMware: Snapshot erstellen
# Bei Cloud: Instanz-Image erstellen
</code>

**Wichtige Dateien f√ºr sp√§tere Backups:**
  * `/var/www/html/nextcloud/config/config.php`
  * `/var/www/html/nextcloud/data/` (Benutzerdaten)
  * MariaDB-Datenbank (`nextcloud`)

===== Checkliste vor Installation =====

**Vor dem n√§chsten Schritt pr√ºfen:**

  * ‚òê Ubuntu 24.04 LTS l√§uft
  * ‚òê Mindestens 10 GB freier Speicherplatz
  * ‚òê Internetverbindung verf√ºgbar
  * ‚òê IP-Adresse des Servers notiert
  * ‚òê System ist aktuell (`apt update && apt upgrade`)
  * ‚òê Firewall-Einstellungen gepr√ºft
  * ‚òê Backup/Snapshot erstellt (falls VM)
  * ‚òê Terminal/SSH-Zugang funktioniert

===== H√§ufige Stolpersteine vermeiden =====

**‚ö†Ô∏è Vermeiden Sie diese Fehler:**

  * **Unvollst√§ndige Updates:** Immer `apt update && apt upgrade` vor Installation
  * **Firewall vergessen:** HTTP-Port 80 muss erreichbar sein
  * **Speicherplatz:** Mindestens 20% freien Speicherplatz lassen
  * **Berechtigungen:** Niemals `chmod 777` verwenden
  * **Mixed Tutorials:** Nur einer Anleitung folgen, nicht mehrere vermischen

===== Weiter zur Installation =====

**Sie sind bereit f√ºr den n√§chsten Schritt:**

üëâ **[[aufgaben:nextcloud_2:02-installation|02 - Installation der Komponenten]]**

**In der n√§chsten Lektion installieren wir:**
  * Apache Webserver
  * MariaDB Datenbank
  * PHP mit erforderlichen Modulen
  * Nextcloud-Software

===== Zus√§tzliche Ressourcen =====

**Offizielle Nextcloud-Dokumentation:**
  * [[https://docs.nextcloud.com/server/stable/admin_manual/installation/system_requirements.html|System Requirements]]
  * [[https://docs.nextcloud.com/server/stable/admin_manual/installation/source_installation.html|Manual Installation]]

**Ubuntu-spezifische Hilfen:**
  * [[https://ubuntu.com/server/docs|Ubuntu Server Guide]]
  * [[https://help.ubuntu.com/community/LAMP|LAMP Stack on Ubuntu]]
